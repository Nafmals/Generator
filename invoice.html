<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Nafithat Al-Amal Co. - Invoice</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    *{
      box-sizing:border-box;
      font-family:Arial, Helvetica, sans-serif;
    }
    body{
      margin:0;
      background:#ffffff;
      display:flex;
      justify-content:center;
      padding:20px;
    }

    /* صفحة الفاتورة (تقريباً A4) */
    .page{
      width:800px;
      min-height:1123px;
      padding:40px 45px;
      position:relative;
      border:1px solid #ddd;
      background:#fff;
    }

    /* شعار شفاف في الخلفية (Watermark) */
    .page::before{
      content:"";
      position:absolute;
      right:40px;
      bottom:80px;
      width:260px;
      height:120px;
      background:url("logo.jpg") no-repeat center center;
      background-size:contain;
      opacity:0.05;
      filter:grayscale(1);
      pointer-events:none;
      z-index:0;
    }

    .content{
      position:relative;
      z-index:1;
      font-size:11px;
      color:#111;
    }

    /* زر طباعة */
    @media screen{
      .print-btn{
        position:fixed;
        right:20px;
        top:20px;
        padding:6px 10px;
        font-size:11px;
        border:1px solid #ccc;
        background:#f5f5f5;
        cursor:pointer;
        z-index:9999;
      }
    }
    @media print{
      body{ margin:0; padding:0; }
      .page{
        border:none;
        padding:20mm 18mm;
        width:100%;
        min-height:auto;
      }
      .print-btn{ display:none; }
    }

    /* رأس الصفحة */
    .header{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
    }
    .company-info{
      max-width:280px;
      line-height:1.35;
    }
    .company-name{
      font-size:14px;
      font-weight:bold;
      color:#f97316;
      margin-bottom:4px;
    }
    .company-info p{
      margin:0;
      font-size:10px;
    }

    .invoice-right{
      text-align:right;
    }
    .invoice-logo{
      text-align:center;
      margin-bottom:4px;
    }
    .invoice-logo img{
      height:48px;
      display:block;
      margin:0 auto;
    }
    .invoice-logo span{
      display:block;
      font-size:12px;
      color:#f97316;
      margin-top:2px;
    }

    .invoice-meta{
      font-size:10px;
      margin-top:4px;
    }
    .meta-row{
      display:flex;
      justify-content:flex-end;
      align-items:center;
      margin-bottom:2px;
      gap:6px;
    }
    .meta-row span.label{
      font-weight:bold;
    }
    .meta-row input{
      border:1px solid #000;
      border-radius:0;
      padding:2px 4px;
      font-size:10px;
      min-width:170px;
    }

    /* العنوان في الوسط */
    .invoice-center-title{
      text-align:center;
      margin-top:10px;
      margin-bottom:6px;
      font-size:14px;
      font-weight:normal;
      color:#555;
    }

    /* Bill To + Description */
    .top-blocks{
      display:flex;
      justify-content:space-between;
      gap:16px;
      margin-top:4px;
    }
    .bill-box{
      width:48%;
      font-size:10px;
    }
    .bill-label{
      font-weight:bold;
      margin-bottom:2px;
    }
    .bill-textarea{
      width:100%;
      min-height:85px;
      border:1px solid #000;
      padding:4px;
      font-size:10px;
      resize:vertical;
      white-space:pre-wrap;
    }

    /* جدول الخدمات */
    table{
      border-collapse:collapse;
      width:100%;
    }
    th, td{
      border:1px solid #000;
      padding:3px 4px;
      font-size:10px;
      vertical-align:top;
    }
    th{
      font-weight:bold;
      text-align:center;
      background:#f5f5f5;
    }
    .desc-header-row th{
      border-bottom:none;
      background:transparent;
    }
    .desc-label-row th{
      border-top:none;
    }
    .text-right{ text-align:right; }
    .text-center{ text-align:center; }

    .cell-input, .cell-textarea{
      width:100%;
      border:none;
      padding:0;
      margin:0;
      font-size:10px;
      background:transparent;
    }
    .cell-textarea{
      resize:vertical;
      min-height:28px;
    }
    .cell-input:focus,
    .cell-textarea:focus{
      outline:none;
    }

    /* زر إضافة سطر */
    .add-row-bar{
      text-align:left;
      margin-top:4px;
      font-size:10px;
    }
    .add-row-btn{
      padding:4px 8px;
      border:1px solid #ccc;
      background:#f5f5f5;
      font-size:10px;
      cursor:pointer;
      border-radius:3px;
    }

    /* شكر */
    .thankyou{
      font-size:9px;
      text-align:left;
      margin-top:4px;
      margin-bottom:8px;
    }

    /* جدول المجاميع */
    .totals{
      margin-top:6px;
      width:260px;
      margin-left:auto;
      font-size:9px;
      border-collapse:collapse;
    }
    .totals td{
      padding:2px 4px;
      border:1px solid #000;
    }
    .totals td:first-child{
      text-align:right;
      font-weight:bold;
      width:60%;
    }
    .totals td:last-child{
      text-align:right;
      min-width:100px;
    }
    .totals input{
      width:100%;
      border:none;
      text-align:right;
      font-size:9px;
      padding:0;
      background:transparent;
    }
    .totals input:focus{
      outline:none;
    }
    .balance{
      font-weight:bold;
    }

    /* Scope + Bank */
    .bottom-row{
      display:flex;
      justify-content:space-between;
      margin-top:22px;
      font-size:9px;
      gap:20px;
    }
    .scope-col{
      width:55%;
    }
    .scope-label{
      font-weight:bold;
      margin-bottom:3px;
    }
    .scope-textarea{
      width:100%;
      min-height:70px;
      border:1px solid #000;
      padding:4px;
      font-size:9px;
      resize:vertical;
      white-space:pre-wrap;
    }

    .bank-col{
      width:40%;
    }
    .bank-label{
      font-weight:bold;
      margin-bottom:3px;
    }
    .bank-table{
      width:100%;
      border-collapse:collapse;
    }
    .bank-table td{
      border:none;
      padding:1px 0;
      font-size:9px;
    }
    .bank-table td:first-child{
      font-weight:bold;
      width:40%;
    }

    /* توقيع وختم */
    .sign-row{
      margin-top:35px;
      display:flex;
      justify-content:flex-start;
      align-items:flex-end;
      gap:18px;
      font-size:9px;
    }
    .sign-block{
      min-width:140px;
    }
    .sign-name{
      margin-top:18px;
      border-top:1px solid #000;
      width:160px;
      padding-top:3px;
      font-size:9px;
    }
    .sign-name span:first-child{
      font-weight:bold;
    }
    .sign-stamp{
      width:110px;
      height:110px;
      position:relative;
    }
    .sign-stamp img{
      width:100%;
      height:100%;
      object-fit:contain;
    }
  </style>
</head>
<body>
  <button class="print-btn" onclick="window.print()">Print / PDF</button>

  <div class="page">
    <div class="content">
      <!-- الرأس -->
      <div class="header">
        <div class="company-info">
          <div class="company-name">Nafithat Al-Amal Co.</div>
          <p>Address: Baghdad - Al-Wahda District - Street 52</p>
          <p>&nbsp;</p>
          <p>Email: sales@nafmals.com</p>
          <p>www.nafmals.com</p>
          <p>Phone Number: 07723571779</p>
        </div>

        <div class="invoice-right">
          <div class="invoice-logo">
            <img src="logo.jpg" alt="Logo">
            <span>Invoice</span>
          </div>
          <div class="invoice-meta">
            <div class="meta-row">
              <span class="label">Invoice No:</span>
              <input id="inv-no" value="NA-2025-D-INV00038">
            </div>
            <div class="meta-row">
              <span class="label">Invoice Date:</span>
              <input id="inv-date" value="5-Dec-25">
            </div>
            <div class="meta-row">
              <span class="label">Contract Number</span>
              <input id="inv-contract" value="4400013503">
            </div>
          </div>
        </div>
      </div>

      <!-- كلمة Invoice في المنتصف مثل النموذج -->
      <div class="invoice-center-title">Invoice</div>

      <!-- Bill To + Description -->
      <div class="top-blocks">
        <div class="bill-box">
          <div class="bill-label">Bill To:</div>
          <textarea class="bill-textarea" id="bill-to">Crescent Petroleum
Iraq-Baghdad -Al Mansur
Mr. Mohammad Rida
Phone number: 07859311699</textarea>
        </div>
        <div class="bill-box">
          <!-- تركنا هذه الخانة فارغة حسب النموذج (العنوان في الوسط) -->
        </div>
      </div>

      <!-- جدول الخدمات -->
      <table style="margin-top:10px;">
        <thead>
          <tr class="desc-header-row">
            <th colspan="8">Description of Services</th>
          </tr>
          <tr class="desc-label-row">
            <th style="width:30px;">No.</th>
            <th>DESCRIPTION</th>
            <th style="width:80px;">Tawer No.</th>
            <th style="width:80px;">DATE</th>
            <th style="width:55px;">UNIT</th>
            <th style="width:50px;">QTY</th>
            <th style="width:95px;">UNIT PRICE</th>
            <th style="width:105px;">TOTAL PRICE</th>
          </tr>
        </thead>
        <tbody id="items-body">
          <!-- سطر افتراضي 1 -->
          <tr class="item-row">
            <td class="text-center no-cell">1</td>
            <td>
              <textarea class="cell-textarea cell-desc">Site Visit</textarea>
            </td>
            <td>
              <input class="cell-input cell-tower" value="Diyala KAI">
            </td>
            <td>
              <input class="cell-input cell-date" value="29-11-25">
            </td>
            <td class="text-center">
              <input class="cell-input cell-unit" value="Trip">
            </td>
            <td class="text-center">
              <input class="cell-input cell-qty" type="number" value="1" min="0">
            </td>
            <td class="text-right">
              <input class="cell-input cell-unitprice" type="number" value="0" min="0">
            </td>
            <td class="text-right">
              <input class="cell-input cell-total" type="text" value="IQD 0" readonly>
            </td>
          </tr>

          <!-- سطر افتراضي 2 -->
          <tr class="item-row">
            <td class="text-center no-cell">2</td>
            <td>
              <textarea class="cell-textarea cell-desc">Preventive Maintenance (4×30 kVA units)</textarea>
            </td>
            <td>
              <input class="cell-input cell-tower" value="Tower 7">
            </td>
            <td>
              <input class="cell-input cell-date" value="29-11-25">
            </td>
            <td class="text-center">
              <input class="cell-input cell-unit" value="EA">
            </td>
            <td class="text-center">
              <input class="cell-input cell-qty" type="number" value="1" min="0">
            </td>
            <td class="text-right">
              <input class="cell-input cell-unitprice" type="number" value="150000" min="0">
            </td>
            <td class="text-right">
              <input class="cell-input cell-total" type="text" value="" readonly>
            </td>
          </tr>

          <!-- سطر افتراضي 3 -->
          <tr class="item-row">
            <td class="text-center no-cell">3</td>
            <td>
              <textarea class="cell-textarea cell-desc">Supply of materials, including Rocker Arm refurbishment and replacement of worn components as part of the engine maintenance, along with engine oil, filters, water, coolant, O-rings, and other related components.</textarea>
            </td>
            <td>
              <input class="cell-input cell-tower" value="Tower 7">
            </td>
            <td>
              <input class="cell-input cell-date" value="29-11-25">
            </td>
            <td class="text-center">
              <input class="cell-input cell-unit" value="lot">
            </td>
            <td class="text-center">
              <input class="cell-input cell-qty" type="number" value="1" min="0">
            </td>
            <td class="text-right">
              <input class="cell-input cell-unitprice" type="number" value="1150000" min="0">
            </td>
            <td class="text-right">
              <input class="cell-input cell-total" type="text" value="" readonly>
            </td>
          </tr>

          <!-- سطر افتراضي 4 -->
          <tr class="item-row">
            <td class="text-center no-cell">4</td>
            <td>
              <textarea class="cell-textarea cell-desc">Motor fixing due to water ingress into the display screen</textarea>
            </td>
            <td>
              <input class="cell-input cell-tower" value="Tower 5">
            </td>
            <td>
              <input class="cell-input cell-date" value="29-11-25">
            </td>
            <td class="text-center">
              <input class="cell-input cell-unit" value="EA">
            </td>
            <td class="text-center">
              <input class="cell-input cell-qty" type="number" value="1" min="0">
            </td>
            <td class="text-right">
              <input class="cell-input cell-unitprice" type="number" value="0" min="0">
            </td>
            <td class="text-right">
              <input class="cell-input cell-total" type="text" value="IQD 0" readonly>
            </td>
          </tr>
        </tbody>
      </table>

      <div class="add-row-bar">
        <button type="button" class="add-row-btn" id="add-row-btn">+ إضافة سطر جديد</button>
      </div>

      <div class="thankyou">
        Thank you for your business!
      </div>

      <!-- المجاميع -->
      <table class="totals">
        <tr>
          <td>SUBTOTAL</td>
          <td><input id="subtotal" readonly></td>
        </tr>
        <tr>
          <td>DISCOUNT</td>
          <td><input id="discount" type="number" value="0"></td>
        </tr>
        <tr>
          <td>SUBTOTAL LESS DISCOUNT</td>
          <td><input id="subtotal-less" readonly></td>
        </tr>
        <tr>
          <td>TAX (0%)</td>
          <td><input id="tax-percent" type="number" value="0"></td>
        </tr>
        <tr>
          <td>SHIPPING/HANDLING</td>
          <td><input id="shipping" type="number" value="0"></td>
        </tr>
        <tr>
          <td class="balance">Balance Due</td>
          <td><input id="balance" class="balance" readonly></td>
        </tr>
      </table>

      <!-- Scope + Bank -->
      <div class="bottom-row">
        <div class="scope-col">
          <div class="scope-label">Scope of Work:</div>
          <textarea class="scope-textarea" id="scope-text">1-The scope covers the provision of all materials required for engine maintenance, including Rocker Arm refurbishment and replacement of worn components, in addition to engine oil, filters, water, coolant, O-rings, and all other related parts and consumables necessary to return the engine to full operational efficiency.

2-Inspection and corrective repair of the motor affected by water ingress into the display screen. The service covers troubleshooting, drying/cleaning of internal components, restoring display functionality, and ensuring reliable operation of the unit after repair.</textarea>
        </div>
        <div class="bank-col">
          <div class="bank-label">Bank Account details</div>
          <table class="bank-table">
            <tr>
              <td>Account Name:</td>
              <td>Nafithat Al-Amal</td>
            </tr>
            <tr>
              <td>IBAN Code:</td>
              <td>IQ07NISB002000000314765</td>
            </tr>
            <tr>
              <td>Account Number:</td>
              <td>314765</td>
            </tr>
            <tr>
              <td>Bank:</td>
              <td>National Islamic Bank</td>
            </tr>
            <tr>
              <td>Currency:</td>
              <td>Iraqi Dinar</td>
            </tr>
            <tr>
              <td>Branch:</td>
              <td>Al-Kadhimiya Branch</td>
            </tr>
          </table>
        </div>
      </div>

      <!-- توقيع وختم -->
      <div class="sign-row">
        <div class="sign-block">
          <div class="sign-name">
            <span>Ayad Kazem</span><br>
            <span>Signature</span>
          </div>
        </div>
        <div class="sign-stamp">
          <!-- لو عندك ختم دائري احفظه باسم stamp.png ثم فعّل السطر التالي -->
          <!-- <img src="stamp.png" alt="Stamp"> -->
        </div>
      </div>
    </div>
  </div>

  <script>
    function formatIQD(n){
      n = Number(n) || 0;
      return "IQD " + n.toLocaleString("en-US");
    }

    function parseNumber(val){
      if(typeof val !== "string") val = String(val||"");
      // إزالة IQD والفواصل وأي فراغات
      return Number(val.replace(/[^\d.-]/g,"")) || 0;
    }

    function updateRowNumbers(){
      document.querySelectorAll(".item-row .no-cell").forEach((td,idx)=>{
        td.textContent = idx + 1;
      });
    }

    function recalcRow(tr){
      const qty = parseNumber(tr.querySelector(".cell-qty").value);
      const up  = parseNumber(tr.querySelector(".cell-unitprice").value);
      const total = qty * up;
      tr.querySelector(".cell-total").value = formatIQD(total);
      return total;
    }

    function recalcAll(){
      const rows = document.querySelectorAll("#items-body .item-row");
      let subtotal = 0;
      rows.forEach(tr => subtotal += recalcRow(tr));

      const discount = parseNumber(document.getElementById("discount").value);
      const taxPercent = parseNumber(document.getElementById("tax-percent").value);
      const shipping = parseNumber(document.getElementById("shipping").value);

      const subtotalLess = subtotal - discount;
      const taxValue = subtotalLess * (taxPercent / 100);
      const balance = subtotalLess + taxValue + shipping;

      document.getElementById("subtotal").value = formatIQD(subtotal);
      document.getElementById("subtotal-less").value = formatIQD(subtotalLess);
      document.getElementById("balance").value = formatIQD(balance);
    }

    function attachRowEvents(tr){
      tr.querySelectorAll(".cell-qty, .cell-unitprice").forEach(el=>{
        el.addEventListener("input", recalcAll);
      });
    }

    // ربط الأحداث للسطر الموجودة
    document.querySelectorAll("#items-body .item-row").forEach(attachRowEvents);

    // حقول المجاميع
    document.getElementById("discount").addEventListener("input", recalcAll);
    document.getElementById("tax-percent").addEventListener("input", recalcAll);
    document.getElementById("shipping").addEventListener("input", recalcAll);

    // إضافة سطر جديد
    document.getElementById("add-row-btn").addEventListener("click", ()=>{
      const body = document.getElementById("items-body");
      const tr = document.createElement("tr");
      tr.className = "item-row";
      tr.innerHTML = `
        <td class="text-center no-cell"></td>
        <td><textarea class="cell-textarea cell-desc"></textarea></td>
        <td><input class="cell-input cell-tower"></td>
        <td><input class="cell-input cell-date"></td>
        <td class="text-center"><input class="cell-input cell-unit"></td>
        <td class="text-center"><input class="cell-input cell-qty" type="number" value="1" min="0"></td>
        <td class="text-right"><input class="cell-input cell-unitprice" type="number" value="0" min="0"></td>
        <td class="text-right"><input class="cell-input cell-total" type="text" value="IQD 0" readonly></td>
      `;
      body.appendChild(tr);
      attachRowEvents(tr);
      updateRowNumbers();
      recalcAll();
    });

    // تحديث الأرقام وحساب أولي
    updateRowNumbers();
    recalcAll();
  </script>
</body>
</html>
